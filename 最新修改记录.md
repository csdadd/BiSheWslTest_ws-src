# 修改记录

## 问题描述
将日志系统的 SystemMonitor 和 RobotStatus 中带有 "Nav2 is active" 的日志条目改成高频级别（HIGHFREQ），其他不带有 "Nav2 is active" 的日志条目级别不变。

## 修改文件列表
- `renwu/systemmonitorthread.cpp`: 修改 processROSLog() 和 onDiagnosticsReceived() 函数，将包含 "Nav2 is active" 的日志改为 HIGHFREQ 级别
- `renwu/mainwindow.cpp`: 修改 onDiagnosticsReceived() 函数，将包含 "Nav2 is active" 的日志改为 HIGHFREQ 级别

## 修改详情

### renwu/systemmonitorthread.cpp

**修改位置1**: 行131-133 (函数: SystemMonitorThread::processROSLog)

```cpp
// 在 switch 语句后添加
if (message.contains("Nav2 is active")) {
    level = LogLevel::HIGHFREQ;
}
```

**修改位置2**: 行195-197 (函数: SystemMonitorThread::onDiagnosticsReceived)

```cpp
// 在 monitorLevel 赋值后添加
if (message.contains("Nav2 is active")) {
    monitorLevel = LogLevel::HIGHFREQ;
}
```

### renwu/mainwindow.cpp

**修改位置**: 行650-652 (函数: MainWindow::onDiagnosticsReceived)

```cpp
// 在 logLevel 赋值后添加
if (message.contains("Nav2 is active")) {
    logLevel = LogLevel::HIGHFREQ;
}
```

## 解决方案摘要

- **问题分析**：日志系统中 "Nav2 is active" 消息来自两个来源：
  1. `/rosout_agg` 话题 → `SystemMonitorThread::processROSLog()`
  2. `/diagnostics` 话题 → `RobotStatusThread::processDiagnosticsData()` → `MainWindow::onDiagnosticsReceived()`

- **解决思路**：在日志级别确定后，检查消息内容是否包含 "Nav2 is active"，如果包含则将级别覆盖为 `LogLevel::HIGHFREQ`

- **关键修改**：在三个日志处理函数中添加条件判断，使用 `QString::contains()` 方法检测消息内容

- **验证方法**：运行程序后观察日志，确认包含 "Nav2 is active" 的日志条目显示为高频级别，其他日志级别保持不变

---
记录时间: 2026-02-13 11:22:15
